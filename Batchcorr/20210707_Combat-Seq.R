# install.packages("devtools")
devtools::install_github("zhangyuqing/sva-devel", force = TRUE)
protein_data1 = read.delim(file = 'submitted_rawdata.tsv', header=TRUE, row.names = 1)
View(protein_data1)
protein_data1[is.na(protein_data1)] <- 0
View(protein_data1)
protein_sample_info1 <- read.delim(file = 'protein_sample_info.tsv')
View(protein_sample_info1)

cov1 <- rep(c(0,1), 36)
cov2 <- c(70.8888855,	63.81666565,	71.3777771,	38.40000153,	38.15833282,	52.65000153,	78.81111145,	63.53055191,	66.95278168,	28.43611145,	55.52500153,	57.44444275,	54.95555496,	77.90833282,	70.53055573,	72.59166718,	90.07221985,	64.83611298,	29.17499924,	61.89444351,	56.41944504,	68.6305542,	68.04444122,	70.43333435,	29.9972229,	35.08611298,	65.70277405,	72.07499695,	70.06666565,	59.42499924,	65.83333588,	56.3777771,	78.46111298,	67.7388916,	55.41388702,	71.5027771,	55.32222366,	73.07777405,	59.34166718,	45.1194458,	64.6388855,	71.7611084,	66.42222595,	62.4944458,	74.48332977,	59.28610992,	61.5083313,	76.94721985,	55.42499924,	71.83333588,	77.8611145,	58.91388702,	56.375,	66.14444733,	56.93333435,	63.98888779,	72.45555878,	76.85832977,	52.06111145,	52.40555573,	66.15000153,	70.68611145,	60.54444504,	61.28055573,	72.17500305,	65.34166718,	46.22222137,	60.22222137,	56.18888855,	59.77500153,	79.2527771,	58.16666794)
cov3 <- c(1,	1,	1,	2,	2,	1,	1,	1,	1,	2,	1,	1,	1,	1,	1,	1,	1,	1,	2,	1,	1,	1,	1,	1,	2,	2,	1,	1,	1,	1,	1,	1,	1,	1,	2,	1,	1,	1,	1,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	1,	1,	1,	1,	1,	1,	2,	1,	1,	1,	1,	1)
cov4 <- c(0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	3,	4,	1,	4,	4,	4,	4,	3,	4,	4,	4,	3,	3,	3,	3,	3,	1,	3,	3,	3,	4,	4,	3,	3,	3,	3,	3,	3,	3,	1,	3,	3,	3,	4)
cov5 <- c(24,	23,	28,	49,	36,	22,	35,	20,	21,	19,	23,	24,	23,	25,	22,	27,	22,	18,	46,	52,	26,	29,	22,	35,	21,	20,	23,	27,	22,	26,	20,	25,	26,	34,	26,	32,	22,	30,	20,	35,	22,	21,	28,	21,	20,	23,	41,	19,	48,	23,	21,	26,	27,	25,	27,	43,	23,	21,	34,	28,	23,	28,	23,	20,	29,	19,	24,	30,	25,	21,	38,	23)
cov6 <- c(16,	15,	4,	17,	29,	20,	13,	8,	16,	71,	65,	15,	7,	141,	13,	51,	245,	18,	7,	94,	12,	45,	40,	12,	71,	57,	3,	8,	17,	40,	6,	54,	34,	31,	43,	57,	391,	225,	79,	546,	41,	10320,	788,	1115,	241,	128,	7230,	4579,	501,	127,	115,	3042,	2942,	159,	96,	132,	3232,	464,	6104,	179,	65,	65,	173,	388,	217,	820,	180,	59,	3098,	565,	1285,	2392)
covar_mat <- cbind(cov1, cov2, cov3, cov4, cov5, cov6)


adjusted_counts <- ComBat_seq(protein_data1, batch=protein_sample_info1$Batch, group=NULL, covar_mod = covar_mat )
results_combat_seq<- adjusted_counts
write.xlsx(results_combat,file="Combat_MDNorm_NM_BatchCorrect_with_combat_seq.xlsx")